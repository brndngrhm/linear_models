#hw_2

#4----
y <- matrix(c(105, 94, 108, 101, 100,
              96, 119, 103, 107, 110, 112, 106,
              120, 114, 121, 116, 128, 115, 118, 123),
            nrow = 20, ncol = 1)
#a
x <- matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
              1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
              0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,
              0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1), 
               nrow = 20, ncol = 4)

names(x)[1] <- "Mean"
names(x)[2] <- "A"
names(x)[3] <- "B"
names(x)[4] <- "C"

design <- t(x) %*% x
x.prime.y <- t(x) %*% y

#b
xb <- matrix(c(1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
              0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,
              0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1), 
              nrow = 20, ncol = 3)

design.b <- t(xb) %*% x.b
xb.prime.y <- t(xb) %*% y
beta.b <- solve(design.b) %*% xb.prime.y

#c
xc <- matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
               1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
               0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0), 
               nrow = 20, ncol = 3)

design.c <- t(xc) %*% xc
xc.prime.y <- t(xc) %*% y
beta.c <- solve(design.c) %*% xc.prime.y

#d
xd <- matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
                1,1,1,1,1,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,
                0,0,0,0,0,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1), 
               nrow = 20, ncol = 3)

design.d <- t(xd) %*% xd
xd.prime.y <- t(xd) %*% y
beta.d <- solve(design.d) %*% xd.prime.y